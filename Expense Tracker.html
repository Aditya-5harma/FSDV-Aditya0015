<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container {
            width: 80%;
            margin: 20px auto;
        }
        .expense-table {
            margin-top: 30px;
        }
        .expense-form {
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header class="text-center bg-primary text-white py-4">
        <h1>Personal Finance Tracker</h1>
        <p>Track your expenses and visualize your spending trends</p>
    </header>

    <!-- Expense Entry Form -->
    <section class="expense-form">
        <div class="container">
            <h3>Enter Your Expense</h3>
            <form id="expenseForm">
                <div class="mb-3">
                    <label for="expenseAmount" class="form-label">Amount</label>
                    <input type="number" class="form-control" id="expenseAmount" required>
                </div>
                <div class="mb-3">
                    <label for="expenseCategory" class="form-label">Category</label>
                    <select class="form-select" id="expenseCategory" required>
                        <option value="Food">Food</option>
                        <option value="Transport">Transport</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Bills">Bills</option>
                        <option value="Shopping">Shopping</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="expenseDate" class="form-label">Date</label>
                    <input type="date" class="form-control" id="expenseDate" required>
                </div>
                <button type="submit" class="btn btn-primary">Add Expense</button>
            </form>
        </div>
    </section>

    <!-- Expense Table Section -->
    <section class="expense-table">
        <div class="container">
            <h3>Recent Expenses</h3>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Amount</th>
                        <th scope="col">Category</th>
                        <th scope="col">Date</th>
                    </tr>
                </thead>
                <tbody id="expenseTableBody">
                    <!-- Dynamic rows will be inserted here -->
                </tbody>
            </table>
        </div>
    </section>

    <!-- Spending Visualization (Pie Chart) -->
    <section class="chart-container">
        <h3>Spending by Category</h3>
        <canvas id="spendingChart"></canvas>
    </section>

    <!-- Prediction Section -->
    <section class="container">
        <h3>Predicted Expenses for Next Month</h3>
        <div class="alert alert-info" id="predictionResult">
            <!-- Prediction results will be shown here -->
        </div>
    </section>

    <!-- Footer Section -->
    <footer class="text-center bg-light py-3">
        <p>&copy; 2025 Personal Finance Tracker</p>
    </footer>

    <!-- JavaScript Code -->
    <script>
        // Initial Data (can be fetched from the backend or stored locally for now)
        let expenses = [
            { amount: 50, category: 'Food', date: '2025-08-01' },
            { amount: 30, category: 'Transport', date: '2025-08-02' },
            { amount: 20, category: 'Entertainment', date: '2025-08-03' },
            { amount: 100, category: 'Bills', date: '2025-08-04' }
        ];

        // Function to render the expenses in the table
        function renderExpenseTable() {
            const tableBody = document.getElementById('expenseTableBody');
            tableBody.innerHTML = '';
            expenses.forEach(expense => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${expense.amount}</td>
                    <td>${expense.category}</td>
                    <td>${expense.date}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Function to update the spending chart
        function renderSpendingChart() {
            const categories = ['Food', 'Transport', 'Entertainment', 'Bills', 'Shopping'];
            const spendingData = categories.map(category => {
                return expenses.filter(expense => expense.category === category).reduce((total, expense) => total + expense.amount, 0);
            });

            const ctx = document.getElementById('spendingChart').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: categories,
                    datasets: [{
                        data: spendingData,
                        backgroundColor: ['#FF5733', '#33FF57', '#3357FF', '#F0E68C', '#FFB6C1'],
                        hoverBackgroundColor: ['#FF5733', '#33FF57', '#3357FF', '#F0E68C', '#FFB6C1']
                    }]
                }
            });
        }

        // Function to predict future expenses (simplified example using last month's spending)
        function predictFutureExpenses() {
            // Simple prediction logic: Take average of last month's spending and predict for next month
            const totalSpend = expenses.reduce((sum, expense) => sum + expense.amount, 0);
            const prediction = totalSpend / expenses.length;  // Predict next month as the average of this month
            document.getElementById('predictionResult').innerHTML = `Predicted total expenses for next month: $${prediction.toFixed(2)}`;
        }

        // Handling form submission
        document.getElementById('expenseForm').addEventListener('submit', function (e) {
            e.preventDefault();
            
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const category = document.getElementById('expenseCategory').value;
            const date = document.getElementById('expenseDate').value;

            // Add the new expense to the data
            expenses.push({ amount, category, date });

            // Re-render the table and chart
            renderExpenseTable();
            renderSpendingChart();
            predictFutureExpenses();

            // Reset the form
            document.getElementById('expenseForm').reset();
        });

        // Initial render of the table, chart, and prediction
        renderExpenseTable();
        renderSpendingChart();
        predictFutureExpenses();
    </script>
</body>
</html>
